// <auto-generated />
namespace PTASDynamicsWebhook
{
    using System;
    using System.Threading.Tasks;

    using Microsoft.AspNetCore.Http;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.Azure.WebJobs.Extensions.Http;
    using Microsoft.Extensions.Logging;

    public static class TestDynamicsProcessor
    {
        /// <summary>
        /// Please do not delete... class for testing the function without invoking the queue.
        /// </summary>
        const string Payload = @"{""BusinessUnitId"":""9243cb99-1c6e-e911-a95a-001dd830153b"",""CorrelationId"":""1d37524b-8174-464c-8bfe-aac0919c0ca8"",""Depth"":3,""InitiatingUserAzureActiveDirectoryObjectId"":""00000000-0000-0000-0000-000000000000"",""InitiatingUserId"":""0fdce62d-d71e-4c3b-bf3b-a5642c20bae9"",""InputParameters"":[{""key"":""Target"",""value"":{""__type"":""Entity:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Attributes"":[{""key"":""ptas_percentbaselandvalue"",""value"":122},{""key"":""ptas_dollarspersquarefoot"",""value"":{""__type"":""Money:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Value"":239.07}},{""key"":""ptas_landid"",""value"":""68a4c0e5-337f-ea11-a811-001dd8018230""},{""key"":""modifiedon"",""value"":""\/Date(1630081754000)\/""},{""key"":""modifiedby"",""value"":{""__type"":""EntityReference:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Id"":""0fdce62d-d71e-4c3b-bf3b-a5642c20bae9"",""KeyAttributes"":[],""LogicalName"":""systemuser"",""Name"":null,""RowVersion"":null}},{""key"":""modifiedonbehalfby"",""value"":null},{""key"":""ptas_dollarspersquarefoot_base"",""value"":{""__type"":""Money:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Value"":239.07}}],""EntityState"":null,""FormattedValues"":[],""Id"":""68a4c0e5-337f-ea11-a811-001dd8018230"",""KeyAttributes"":[],""LogicalName"":""ptas_land"",""RelatedEntities"":[],""RowVersion"":null}}],""IsExecutingOffline"":false,""IsInTransaction"":false,""IsOfflinePlayback"":false,""IsolationMode"":1,""MessageName"":""Update"",""Mode"":1,""OperationCreatedOn"":""\/Date(1630081756000+0000)\/"",""OperationId"":""3b7572e8-5307-ec11-94ef-001dd8027576"",""OrganizationId"":""8dcf1c09-56fb-4cdd-af75-54b14b04349b"",""OrganizationName"":""org7ff68ed4"",""OutputParameters"":[],""OwningExtension"":{""Id"":""d6466f61-9106-ec11-94ef-001dd802dd3d"",""KeyAttributes"":[],""LogicalName"":""sdkmessageprocessingstep"",""Name"":null,""RowVersion"":null},""ParentContext"":{""BusinessUnitId"":""9243cb99-1c6e-e911-a95a-001dd830153b"",""CorrelationId"":""1d37524b-8174-464c-8bfe-aac0919c0ca8"",""Depth"":3,""InitiatingUserAzureActiveDirectoryObjectId"":""00000000-0000-0000-0000-000000000000"",""InitiatingUserId"":""0fdce62d-d71e-4c3b-bf3b-a5642c20bae9"",""InputParameters"":[{""key"":""Target"",""value"":{""__type"":""Entity:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Attributes"":[{""key"":""ptas_percentbaselandvalue"",""value"":122},{""key"":""ptas_dollarspersquarefoot"",""value"":{""__type"":""Money:http:\/\/schemas.microsoft.com\/xrm\/2011\/Contracts"",""Value"":239.07}},{""key"":""ptas_landid"",""value"":""68a4c0e5-337f-ea11-a811-001dd8018230""}],""EntityState"":null,""FormattedValues"":[],""Id"":""68a4c0e5-337f-ea11-a811-001dd8018230"",""KeyAttributes"":[],""LogicalName"":""ptas_land"",""RelatedEntities"":[],""RowVersion"":null}},{""key"":""FromSandbox"",""value"":true}],""IsExecutingOffline"":false,""IsInTransaction"":false,""IsOfflinePlayback"":false,""IsolationMode"":1,""MessageName"":""Update"",""Mode"":1,""OperationCreatedOn"":""\/Date(1630081756000+0000)\/"",""OperationId"":""3b7572e8-5307-ec11-94ef-001dd8027576"",""OrganizationId"":""8dcf1c09-56fb-4cdd-af75-54b14b04349b"",""OrganizationName"":""org7ff68ed4"",""OutputParameters"":[],""OwningExtension"":{""Id"":""d6466f61-9106-ec11-94ef-001dd802dd3d"",""KeyAttributes"":[],""LogicalName"":""sdkmessageprocessingstep"",""Name"":null,""RowVersion"":null},""ParentContext"":null,""PostEntityImages"":[],""PreEntityImages"":[],""PrimaryEntityId"":""68a4c0e5-337f-ea11-a811-001dd8018230"",""PrimaryEntityName"":""ptas_land"",""RequestId"":""e1873331-fc9a-4650-8bf4-1ffd9c4d96d4"",""SecondaryEntityName"":""none"",""SharedVariables"":[{""key"":""IsAutoTransact"",""value"":true}],""Stage"":30,""UserAzureActiveDirectoryObjectId"":""00000000-0000-0000-0000-000000000000"",""UserId"":""0fdce62d-d71e-4c3b-bf3b-a5642c20bae9""},""PostEntityImages"":[{""key"":""AsynchronousStepPrimaryName"",""value"":{""Attributes"":[{""key"":""ptas_name"",""value"":""000020-0017 | 408880-1470""},{""key"":""ptas_landid"",""value"":""68a4c0e5-337f-ea11-a811-001dd8018230""}],""EntityState"":null,""FormattedValues"":[],""Id"":""68a4c0e5-337f-ea11-a811-001dd8018230"",""KeyAttributes"":[],""LogicalName"":""ptas_land"",""RelatedEntities"":[],""RowVersion"":null}}],""PreEntityImages"":[],""PrimaryEntityId"":""68a4c0e5-337f-ea11-a811-001dd8018230"",""PrimaryEntityName"":""ptas_land"",""RequestId"":""e1873331-fc9a-4650-8bf4-1ffd9c4d96d4"",""SecondaryEntityName"":""none"",""SharedVariables"":[{""key"":""IsAutoTransact"",""value"":true}],""Stage"":40,""UserAzureActiveDirectoryObjectId"":""00000000-0000-0000-0000-000000000000"",""UserId"":""0fdce62d-d71e-4c3b-bf3b-a5642c20bae9""}";

        [FunctionName("TestDynamicsProcessor")]
        public static async Task<IActionResult> Run(
            [HttpTrigger(AuthorizationLevel.Function, "get", "post", Route = null)] HttpRequest req,
            ILogger log)
        {
            log.LogInformation("C# HTTP trigger function processed a request.");
            try
            {
                await DynamicsQueueChecker.RunAsync(Payload, log);
                return new OkObjectResult("Finished!");

            }
            catch (Exception ex)
            {
                return new OkObjectResult(ex.Message);
            }

        }
    }
}